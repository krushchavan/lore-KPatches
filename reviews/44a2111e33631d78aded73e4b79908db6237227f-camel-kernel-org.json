{
  "thread_id": "44a2111e33631d78aded73e4b79908db6237227f.camel@kernel.org",
  "subject": "[PATCH] Add support for empty path in openat and openat2 syscalls",
  "url": "https://lore.kernel.org/all/44a2111e33631d78aded73e4b79908db6237227f.camel@kernel.org/",
  "dates": {
    "2026-02-23": {
      "report_file": "2026-02-23_ollama_llama3.1-8b.html",
      "developer": "Jeff Layton",
      "reviews": [
        {
          "author": "Jeff Layton",
          "summary": "Reviewer suggested that the O_EMPTY_PATH flag should be an OPENAT2_* flag instead, citing recent discussion around O_REGULAR flag",
          "sentiment": "needs_work",
          "sentiment_signals": [
            "requested changes"
          ],
          "has_inline_review": false,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "llm",
          "raw_body": "This sounds valuable, but there was recent discussion around the\nO_REGULAR flag that said that we shouldn't be adding new flags to older\nsyscalls [1]. Should this only be an OPENAT2_* flag instead?\n\n[1]: https://lore.kernel.org/linux-fsdevel/20260129-siebzehn-adler-efe74ff8f1a9@brauner/",
          "reply_to": "Jori Koolstra",
          "message_date": "2026-02-23"
        },
        {
          "author": "David Laight",
          "summary": "Reviewer noted that the O_EMPTY_PATH flag is not properly handled in the build_open_flags function, which does not set LOOKUP_EMPTY when O_EMPTY_PATH is specified.\n\nReviewer David Laight questioned the usefulness of allowing empty path in openat and openat2 syscalls for files, citing security concerns and lack of clear use cases.",
          "sentiment": "needs_work",
          "sentiment_signals": [
            "flag handling issue",
            "security concern",
            "lack of clear use case"
          ],
          "has_inline_review": true,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "llm",
          "raw_body": "On Mon, 23 Feb 2026 16:16:52 +0100\nJori Koolstra <jkoolstra@xs4all.nl> wrote:\n\n---\n\nWhat do you want the fd for?\nThere are good reasons for wanting an fd for a directory that you don't\nhave access permissions for, but what is the use case for a file?\n\nIt all gets very close to letting you do things that the 'security model'\nshould reject.\n\n\tDavid",
          "reply_to": "Jori Koolstra",
          "message_date": "2026-02-23"
        }
      ],
      "analysis_source": "llm-per-reviewer"
    },
    "2026-02-24": {
      "report_file": "2026-02-23_ollama_llama3.1-8b.html",
      "developer": "Jeff Layton",
      "reviews": [
        {
          "author": "Christian Brauner",
          "summary": "I do like restricting it to openat2() as well.",
          "sentiment": "neutral",
          "sentiment_signals": [],
          "has_inline_review": true,
          "tags_given": [],
          "analysis_source": "heuristic",
          "raw_body": "On Mon, Feb 23, 2026 at 10:28:24AM -0500, Jeff Layton wrote:\n> On Mon, 2026-02-23 at 16:16 +0100, Jori Koolstra wrote:\n> > To get an operable version of an O_PATH file descriptors, it is possible\n> > to use openat(fd, \".\", O_DIRECTORY) for directories, but other files\n> > currently require going through open(\"/proc/<pid>/fd/<nr>\") which\n> > depends on a functioning procfs.\n> > \n> > This patch adds the O_EMPTY_PATH flag to openat and openat2. If passed\n> > LOOKUP_EMPTY is set at path resolve time.\n> > \n> \n> This sounds valuable, but there was recent discussion around the\n> O_REGULAR flag that said that we shouldn't be adding new flags to older\n> syscalls [1]. Should this only be an OPENAT2_* flag instead?\n> \n> [1]: https://lore.kernel.org/linux-fsdevel/20260129-siebzehn-adler-efe74ff8f1a9@brauner/\n\nI do like restricting it to openat2() as well.\n",
          "reply_to": "",
          "message_date": "2026-02-24",
          "message_id": ""
        },
        {
          "author": "Jori Koolstra",
          "summary": "So would you want to filter the O_EMPTY_PATH flag from openat(), or maybe add a RESOLVE_EMPTY flag to the resolve options?",
          "sentiment": "neutral",
          "sentiment_signals": [],
          "has_inline_review": true,
          "tags_given": [],
          "analysis_source": "heuristic",
          "raw_body": "\n> Op 24-02-2026 11:10 CET schreef Christian Brauner <brauner@kernel.org>:\n> \n>  \n> On Mon, Feb 23, 2026 at 10:28:24AM -0500, Jeff Layton wrote:\n> > On Mon, 2026-02-23 at 16:16 +0100, Jori Koolstra wrote:\n> > > To get an operable version of an O_PATH file descriptors, it is possible\n> > > to use openat(fd, \".\", O_DIRECTORY) for directories, but other files\n> > > currently require going through open(\"/proc/<pid>/fd/<nr>\") which\n> > > depends on a functioning procfs.\n> > > \n> > > This patch adds the O_EMPTY_PATH flag to openat and openat2. If passed\n> > > LOOKUP_EMPTY is set at path resolve time.\n> > > \n> > \n> > This sounds valuable, but there was recent discussion around the\n> > O_REGULAR flag that said that we shouldn't be adding new flags to older\n> > syscalls [1]. Should this only be an OPENAT2_* flag instead?\n> > \n> > [1]: https://lore.kernel.org/linux-fsdevel/20260129-siebzehn-adler-efe74ff8f1a9@brauner/\n> \n> I do like restricting it to openat2() as well.\n\nSo would you want to filter the O_EMPTY_PATH flag from openat(), or maybe add\na RESOLVE_EMPTY flag to the resolve options?\n\nThanks,\nJori.\n",
          "reply_to": "",
          "message_date": "2026-02-24",
          "message_id": ""
        },
        {
          "author": "Christian Brauner",
          "summary": "No, add a OPENAT2_EMPTY_PATH in the upper 32 bit of the 64-bit flag argument for struct open_how. Then it cannot be used in openat(). But let's wait a day or so to see whether we have someone that really wants to extend this to openat() as well...",
          "sentiment": "neutral",
          "sentiment_signals": [],
          "has_inline_review": true,
          "tags_given": [],
          "analysis_source": "heuristic",
          "raw_body": "On Tue, Feb 24, 2026 at 02:35:00PM +0100, Jori Koolstra wrote:\n> \n> > Op 24-02-2026 11:10 CET schreef Christian Brauner <brauner@kernel.org>:\n> > \n> >  \n> > On Mon, Feb 23, 2026 at 10:28:24AM -0500, Jeff Layton wrote:\n> > > On Mon, 2026-02-23 at 16:16 +0100, Jori Koolstra wrote:\n> > > > To get an operable version of an O_PATH file descriptors, it is possible\n> > > > to use openat(fd, \".\", O_DIRECTORY) for directories, but other files\n> > > > currently require going through open(\"/proc/<pid>/fd/<nr>\") which\n> > > > depends on a functioning procfs.\n> > > > \n> > > > This patch adds the O_EMPTY_PATH flag to openat and openat2. If passed\n> > > > LOOKUP_EMPTY is set at path resolve time.\n> > > > \n> > > \n> > > This sounds valuable, but there was recent discussion around the\n> > > O_REGULAR flag that said that we shouldn't be adding new flags to older\n> > > syscalls [1]. Should this only be an OPENAT2_* flag instead?\n> > > \n> > > [1]: https://lore.kernel.org/linux-fsdevel/20260129-siebzehn-adler-efe74ff8f1a9@brauner/\n> > \n> > I do like restricting it to openat2() as well.\n> \n> So would you want to filter the O_EMPTY_PATH flag from openat(), or maybe add\n> a RESOLVE_EMPTY flag to the resolve options?\n\nNo, add a OPENAT2_EMPTY_PATH in the upper 32 bit of the 64-bit flag\nargument for struct open_how. Then it cannot be used in openat(). But\nlet's wait a day or so to see whether we have someone that really wants\nto extend this to openat() as well...\n\n",
          "reply_to": "",
          "message_date": "2026-02-24",
          "message_id": ""
        }
      ],
      "analysis_source": "heuristic"
    }
  }
}