{
  "thread_id": "20260224-v4-0-lock-overflow-v1-1-22beeaf5cf6b@kernel.org",
  "subject": "[PATCH] nfsd: fix heap overflow in NFSv4.0 LOCK replay cache",
  "url": "https://lore.kernel.org/all/20260224-v4-0-lock-overflow-v1-1-22beeaf5cf6b@kernel.org/",
  "dates": {
    "2026-02-24": {
      "report_file": "2026-02-24_ollama_llama3.1-8b.html",
      "developer": "Jeff Layton",
      "reviews": [
        {
          "author": "Chuck Lever",
          "summary": "Identified the patch as a fix for a known issue and applied it to nfsd-testing without requesting any changes.",
          "sentiment": "positive",
          "sentiment_signals": [
            "Applied"
          ],
          "has_inline_review": false,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "llm",
          "raw_body": "From: Chuck Lever <chuck.lever@oracle.com>\n\nOn Tue, 24 Feb 2026 11:33:35 -0500, Jeff Layton wrote:\n> The NFSv4.0 replay cache uses a fixed 112-byte inline buffer\n> (rp_ibuf[NFSD4_REPLAY_ISIZE]) to store encoded operation responses.\n> This size was calculated based on OPEN responses and does not account\n> for LOCK denied responses, which include the conflicting lock owner as\n> a variable-length field up to 1024 bytes (NFS4_OPAQUE_LIMIT).\n> \n> When a LOCK operation is denied due to a conflict with an existing lock\n> that has a large owner, nfsd4_encode_operation() copies the full encoded\n> response into the undersized replay buffer via read_bytes_from_xdr_buf()\n> with no bounds check. This results in a slab-out-of-bounds write of up\n> to 944 bytes past the end of the buffer, corrupting adjacent heap memory.\n> \n> [...]\n\nApplied to nfsd-testing, thanks!\n\n[1/1] nfsd: fix heap overflow in NFSv4.0 LOCK replay cache\n      commit: 1e8e9913672a31c6fdd0d237cd3cec88435bd66e\n\n--\nChuck Lever\n\n\n",
          "reply_to": "",
          "message_date": "2026-02-24",
          "message_id": ""
        }
      ],
      "analysis_source": "llm",
      "patch_summary": "This patch fixes a heap overflow vulnerability in the NFSv4.0 LOCK replay cache by adding bounds checking to prevent oversized responses from being copied into an undersized buffer."
    }
  }
}