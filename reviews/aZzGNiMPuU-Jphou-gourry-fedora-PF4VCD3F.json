{
  "thread_id": "aZzGNiMPuU-Jphou@gourry-fedora-PF4VCD3F",
  "subject": "Re: [PATCH v2 1/2] cxl: Test CXL_DECODER_F_LOCK as a bitmask",
  "url": "https://lore.kernel.org/all/aZzGNiMPuU-Jphou@gourry-fedora-PF4VCD3F/",
  "dates": {
    "2026-02-23": {
      "report_file": "2026-02-23_ollama_llama3.1-8b.html",
      "developer": "Gregory Price",
      "reviews": [
        {
          "author": "Gregory Price",
          "summary": "Provided Reviewed-by and Tested-by tags for both patches without raising any concerns or objections.",
          "sentiment": "positive",
          "sentiment_signals": [
            "APPROVAL"
          ],
          "has_inline_review": false,
          "tags_given": [
            "Reviewed-by",
            "Tested-by"
          ],
          "analysis_source": "llm",
          "raw_body": "On Mon, Feb 23, 2026 at 11:13:39AM -0800, Alison Schofield wrote:\n> The CXL decoder flags are defined as bitmasks, not bit indices.\n> Using test_bit() to check them interprets the mask value as a bit\n> index, which is the wrong test.\n> \n> For CXL_DECODER_F_LOCK the test reads beyond the defined bits, causing\n> the test to always return false and allowing resets that should have\n> been blocked.\n> \n> Replace test_bit() with a bitmask check.\n> \n> Fixes: 2230c4bdc412 (\"cxl: Add handling of locked CXL decoder\")\n> Signed-off-by: Alison Schofield <alison.schofield@intel.com>\n> ---\n\nOp, missed the v4 and responded to v1\n\nReviewed-by: Gregory Price <gourry@gourry.net>\nTested-by: Gregory Price <gourry@gourry.net>\n\n",
          "reply_to": "",
          "message_date": "2026-02-23"
        },
        {
          "author": "Dave Jiang",
          "summary": "Applied both patches to cxl/fixes without raising any concerns or objections.",
          "sentiment": "positive",
          "sentiment_signals": [
            "APPROVAL"
          ],
          "has_inline_review": false,
          "tags_given": [],
          "analysis_source": "llm",
          "raw_body": "\n\nOn 2/23/26 12:13 PM, Alison Schofield wrote:\n> The CXL decoder flags are defined as bitmasks, not bit indices.\n> Using test_bit() to check them interprets the mask value as a bit\n> index, which is the wrong test.\n> \n> For CXL_DECODER_F_LOCK the test reads beyond the defined bits, causing\n> the test to always return false and allowing resets that should have\n> been blocked.\n> \n> Replace test_bit() with a bitmask check.\n> \n> Fixes: 2230c4bdc412 (\"cxl: Add handling of locked CXL decoder\")\n> Signed-off-by: Alison Schofield <alison.schofield@intel.com>\n\nApplied to cxl/fixes\n8c0025ee29f03d74d34b77127192b9db8457564c\n\n> ---\n> \n> Changes in v2:\n> Split patches to align w Fixes Tags for backport ease\n> Rebased on 7.0-rc1\n> \n>  drivers/cxl/core/hdm.c    | 2 +-\n>  drivers/cxl/core/region.c | 2 +-\n>  2 files changed, 2 insertions(+), 2 deletions(-)\n> \n> diff --git a/drivers/cxl/core/hdm.c b/drivers/cxl/core/hdm.c\n> index e3f0c39e6812..c222e98ae736 100644\n> --- a/drivers/cxl/core/hdm.c\n> +++ b/drivers/cxl/core/hdm.c\n> @@ -904,7 +904,7 @@ static void cxl_decoder_reset(struct cxl_decoder *cxld)\n>  \tif ((cxld->flags & CXL_DECODER_F_ENABLE) == 0)\n>  \t\treturn;\n>  \n> -\tif (test_bit(CXL_DECODER_F_LOCK, &cxld->flags))\n> +\tif (cxld->flags & CXL_DECODER_F_LOCK)\n>  \t\treturn;\n>  \n>  \tif (port->commit_end == id)\n> diff --git a/drivers/cxl/core/region.c b/drivers/cxl/core/region.c\n> index fec37af1dfbf..780ec947ecf2 100644\n> --- a/drivers/cxl/core/region.c\n> +++ b/drivers/cxl/core/region.c\n> @@ -1100,7 +1100,7 @@ static int cxl_rr_assign_decoder(struct cxl_port *port, struct cxl_region *cxlr,\n>  static void cxl_region_setup_flags(struct cxl_region *cxlr,\n>  \t\t\t\t   struct cxl_decoder *cxld)\n>  {\n> -\tif (test_bit(CXL_DECODER_F_LOCK, &cxld->flags)) {\n> +\tif (cxld->flags & CXL_DECODER_F_LOCK) {\n>  \t\tset_bit(CXL_REGION_F_LOCK, &cxlr->flags);\n>  \t\tclear_bit(CXL_REGION_F_NEEDS_RESET, &cxlr->flags);\n>  \t}\n> \n> base-commit: 6de23f81a5e08be8fbf5e8d7e9febc72a5b5f27f\n\n",
          "reply_to": "",
          "message_date": "2026-02-23"
        }
      ],
      "analysis_source": "llm",
      "patch_summary": "Two patches to fix incorrect bitmask checks in CXL decoder flags, replacing test_bit() with bitwise AND operations."
    }
  }
}