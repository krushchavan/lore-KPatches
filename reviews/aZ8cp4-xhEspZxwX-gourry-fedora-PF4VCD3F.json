{
  "thread_id": "aZ8cp4_xhEspZxwX@gourry-fedora-PF4VCD3F",
  "subject": "[PATCH v2 3/3] cxl: Move pci generic code",
  "url": "https://lore.kernel.org/all/aZ8cp4_xhEspZxwX@gourry-fedora-PF4VCD3F/",
  "dates": {
    "2026-02-25": {
      "report_file": "2026-02-25_ollama_llama3.1-8b.html",
      "developer": "Gregory Price",
      "reviews": [
        {
          "author": "Gregory Price",
          "summary": "Raised a question about whether the redundant port lookup is actually necessary and suggested removing it to simplify the code.",
          "sentiment": "neutral",
          "sentiment_signals": [
            "QUESTION"
          ],
          "has_inline_review": false,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "llm",
          "raw_body": "",
          "reply_to": "",
          "message_date": "",
          "message_id": ""
        }
      ],
      "analysis_source": "llm",
      "patch_summary": "The patch proposes to remove a redundant call to cxl_pci_find_port() in the cxl_rcrb_get_comp_regs() function, simplifying the code and eliminating unnecessary port lookups."
    },
    "2026-02-27": {
      "report_file": "2026-02-25_ollama_llama3.1-8b.html",
      "developer": "Gregory Price",
      "reviews": [
        {
          "author": "Gregory Price",
          "summary": "Raised a question about whether the redundant port lookup is actually necessary and suggested removing it to simplify the code.",
          "sentiment": "neutral",
          "sentiment_signals": [
            "QUESTION"
          ],
          "has_inline_review": false,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "llm",
          "raw_body": "On Fri, Feb 27, 2026 at 07:59:19PM +0000, Alejandro Lucero Palau wrote:\n> > we call cxl_pci_find_port() here twice on the same pdev and pass the\n> > dport into the second caller.\n> > \n> > Can something actually change between these two secnarios?  Seems like\n> > we can just drop the check in cxl_rcrb_get_comp_regs?\n> \n> \n> Uhmm, I do not think we need the second one inside cxl_rcrb_get_comp_regs?\n> \n> I will drop it and mention that in the commit.\n> \n> \n\nSince this is existing code, i would just use the patch i provided below\nas an add-on.  That way if something breaks later it can be bisected\ncleanly without affecting your original movement commit.\n\n~Gregory\n\n> Thank you\n> \n> \n> > ~Gregory\n> > \n> > ---\n> > \n> > cxl/pci: Remove redundant cxl_pci_find_port() call in cxl_rcrb_get_comp_regs()\n> > \n> > Remove the redundant port lookup from cxl_rcrb_get_comp_regs() and use the\n> > dport parameter directly. The caller has already validated the port is\n> > non-NULL before invoking this function.\n> > \n> > Signed-off-by: Gregory Price <gourry@gourry.net>\n> > \n> > diff --git a/drivers/cxl/core/pci.c b/drivers/cxl/core/pci.c\n> > index c32cc62c501d..d1f487b3d809 100644\n> > --- a/drivers/cxl/core/pci.c\n> > +++ b/drivers/cxl/core/pci.c\n> > @@ -707,11 +707,6 @@ static int cxl_rcrb_get_comp_regs(struct pci_dev *pdev,\n> >                  .resource = CXL_RESOURCE_NONE,\n> >          };\n> > \n> > -       struct cxl_port *port __free(put_cxl_port) =\n> > -               cxl_pci_find_port(pdev, &dport);\n> > -       if (!port)\n> > -               return -EPROBE_DEFER;\n> > -\n> >          component_reg_phys = cxl_rcd_component_reg_phys(&pdev->dev, dport);\n> >          if (component_reg_phys == CXL_RESOURCE_NONE)\n> >                  return -ENXIO;\n> > \n\n",
          "reply_to": "",
          "message_date": "2026-02-27",
          "message_id": ""
        }
      ],
      "analysis_source": "llm",
      "patch_summary": "The patch proposes to remove a redundant call to cxl_pci_find_port() in the cxl_rcrb_get_comp_regs() function, simplifying the code and eliminating unnecessary port lookups."
    }
  }
}