{
  "thread_id": "20260217103419.19609-1-mark@harmstone.com",
  "subject": "[PATCH] btrfs: fix incorrect error message in check_dev_extent_item()",
  "url": "https://lore.kernel.org/all/20260217103419.19609-1-mark@harmstone.com/",
  "dates": {
    "2026-02-18": {
      "report_file": "2026-02-18_ollama_llama3.1-8b.html",
      "developer": "Mark Harmstone",
      "reviews": [
        {
          "author": "Qu Wenruo",
          "summary": "Approved the patch with a Reviewed-by tag.",
          "sentiment": "positive",
          "sentiment_signals": [
            "APPROVED"
          ],
          "has_inline_review": false,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "llm",
          "raw_body": "\n\n在 2026/2/17 21:04, Mark Harmstone 写道:\n> Fix the error message in check_dev_extent_item(), when an overlapping\n> stripe is encountered. For dev extents, objectid is the disk number and\n> offset the physical address, so prev_key->objectid should actually be\n> prev_key->offset.\n> \n> (I can't take any credit for this one - this was discovered by Chris and\n> his friend Claude.)\n> \n> Signed-off-by: Mark Harmstone <mark@harmstone.com>\n> Suggested-by: Chris Mason <clm@fb.com>\n> Fixes: 008e2512dc56 (\"btrfs: tree-checker: add dev extent item checks\")\n\nReviewed-by: Qu Wenruo <wqu@suse.com>\n\nThanks,\nQu\n\n> ---\n>   fs/btrfs/tree-checker.c | 2 +-\n>   1 file changed, 1 insertion(+), 1 deletion(-)\n> \n> diff --git a/fs/btrfs/tree-checker.c b/fs/btrfs/tree-checker.c\n> index 452394b34d01..9774779f060b 100644\n> --- a/fs/btrfs/tree-checker.c\n> +++ b/fs/btrfs/tree-checker.c\n> @@ -1921,7 +1921,7 @@ static int check_dev_extent_item(const struct extent_buffer *leaf,\n>   \t\tif (unlikely(prev_key->offset + prev_len > key->offset)) {\n>   \t\t\tgeneric_err(leaf, slot,\n>   \t\t\"dev extent overlap, prev offset %llu len %llu current offset %llu\",\n> -\t\t\t\t    prev_key->objectid, prev_len, key->offset);\n> +\t\t\t\t    prev_key->offset, prev_len, key->offset);\n>   \t\t\treturn -EUCLEAN;\n>   \t\t}\n>   \t}\n\n\n",
          "reply_to": "",
          "message_date": "2026-02-18"
        }
      ],
      "analysis_source": "llm",
      "patch_summary": "This patch fixes an incorrect error message in the btrfs tree-checker's check_dev_extent_item() function, which occurs when an overlapping stripe is encountered. The fix involves changing the comparison of objectid and offset to use the correct field (offset) for prev_key."
    },
    "2026-02-17": {
      "report_file": "2026-02-18_ollama_llama3.1-8b.html",
      "developer": "Mark Harmstone",
      "reviews": [
        {
          "author": "Boris Burkov",
          "summary": "Approved the patch with a Reviewed-by tag.",
          "sentiment": "positive",
          "sentiment_signals": [
            "APPROVED"
          ],
          "has_inline_review": false,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "llm",
          "raw_body": "On Tue, Feb 17, 2026 at 10:34:08AM +0000, Mark Harmstone wrote:\n> Fix the error message in check_dev_extent_item(), when an overlapping\n> stripe is encountered. For dev extents, objectid is the disk number and\n> offset the physical address, so prev_key->objectid should actually be\n> prev_key->offset.\n> \n> (I can't take any credit for this one - this was discovered by Chris and\n> his friend Claude.)\n> \n> Signed-off-by: Mark Harmstone <mark@harmstone.com>\n> Suggested-by: Chris Mason <clm@fb.com>\n\nReviewed-by: Boris Burkov <boris@bur.io>\n\n> Fixes: 008e2512dc56 (\"btrfs: tree-checker: add dev extent item checks\")\n> ---\n>  fs/btrfs/tree-checker.c | 2 +-\n>  1 file changed, 1 insertion(+), 1 deletion(-)\n> \n> diff --git a/fs/btrfs/tree-checker.c b/fs/btrfs/tree-checker.c\n> index 452394b34d01..9774779f060b 100644\n> --- a/fs/btrfs/tree-checker.c\n> +++ b/fs/btrfs/tree-checker.c\n> @@ -1921,7 +1921,7 @@ static int check_dev_extent_item(const struct extent_buffer *leaf,\n>  \t\tif (unlikely(prev_key->offset + prev_len > key->offset)) {\n>  \t\t\tgeneric_err(leaf, slot,\n>  \t\t\"dev extent overlap, prev offset %llu len %llu current offset %llu\",\n> -\t\t\t\t    prev_key->objectid, prev_len, key->offset);\n> +\t\t\t\t    prev_key->offset, prev_len, key->offset);\n>  \t\t\treturn -EUCLEAN;\n>  \t\t}\n>  \t}\n> -- \n> 2.52.0\n> \n",
          "reply_to": "",
          "message_date": "2026-02-17"
        }
      ],
      "analysis_source": "llm",
      "patch_summary": "This patch fixes an incorrect error message in the btrfs tree-checker's check_dev_extent_item() function, which occurs when an overlapping stripe is encountered. The fix involves changing the comparison of objectid and offset to use the correct field (offset) for prev_key."
    }
  }
}