{
  "thread_id": "9476ab2ff783c77ff4f1d323fad3e356bb172fcd.camel@surriel.com",
  "subject": "[PATCH] kfence: add kfence.fault parameter",
  "url": "https://lore.kernel.org/all/9476ab2ff783c77ff4f1d323fad3e356bb172fcd.camel@surriel.com/",
  "dates": {
    "2026-02-25": {
      "report_file": "2026-02-25_ollama_llama3.1-8b.html",
      "developer": "Rik van Riel",
      "reviews": [
        {
          "author": "Rik van Riel",
          "summary": "Raised concerns that making the kfence.fault parameter changeable after init could lead to security issues, such as an attacker being able to circumvent the oops/panic setting.",
          "sentiment": "needs_work",
          "sentiment_signals": [
            "SECURITY_CONCERN"
          ],
          "has_inline_review": false,
          "tags_given": [],
          "analysis_source": "llm",
          "raw_body": "",
          "reply_to": "",
          "message_date": "",
          "message_id": ""
        }
      ],
      "analysis_source": "llm",
      "patch_summary": "The patch adds a new parameter kfence.fault to the kfence module, allowing users to toggle the behavior of KFENCE in case of a fault."
    },
    "2026-02-26": {
      "report_file": "2026-02-25_ollama_llama3.1-8b.html",
      "developer": "Rik van Riel",
      "reviews": [
        {
          "author": "Marco Elver",
          "summary": "Responded to Rik's concerns, explaining that the parameter is meant to give users a knob to reduce the risk of someone taking advantage of KFENCE's heap layout.",
          "sentiment": "positive",
          "sentiment_signals": [
            "DEFENSE"
          ],
          "has_inline_review": false,
          "tags_given": [],
          "analysis_source": "llm",
          "raw_body": "On Wed, 25 Feb 2026 at 23:26, Rik van Riel <riel@surriel.com> wrote:\n>\n> On Wed, 2026-02-25 at 21:36 +0100, Marco Elver wrote:\n> >\n> > +static int __init early_kfence_fault(char *arg)\n> > +{\n> > +     if (!arg)\n> > +             return -EINVAL;\n> > +\n> > +     if (!strcmp(arg, \"report\"))\n> > +             kfence_fault = KFENCE_FAULT_REPORT;\n> > +     else if (!strcmp(arg, \"oops\"))\n> > +             kfence_fault = KFENCE_FAULT_OOPS;\n> > +     else if (!strcmp(arg, \"panic\"))\n> > +             kfence_fault = KFENCE_FAULT_PANIC;\n> > +     else\n> > +             return -EINVAL;\n> > +\n> > +     return 0;\n> > +}\n> > +early_param(\"kfence.fault\", early_kfence_fault);\n>\n> The other parameters in mm/kfence/ seem to be module_param,\n> which make them tunable at run time through\n> /sys/module/kfence/parameters/*\n>\n> Why is this one different?\n\nThat was my first thought too, but after much thought we should not\nmake this changeable after init, see below ...\n\n> And, does this one show up as /sys/module/kfence/parameters/fault?\n>\n> Having the ability to tweak this behavior at run time, without\n> requiring a system reboot, could be really useful for people\n> unexpectedly triggering kernel panics across a fleet of servers,\n> and deciding they would rather not.\n\nIt's intentional - having the ability to switch it after init means\nwe'd have to remove __ro_after_init from the kfence_fault setting. We\nrisk having the system administrator's choice being overridden by\naccident in the exact situation where we do not want it to happen:\neither through memory corruption overwriting that global flag, or it\nmight give an attacker the ability to circumvent the oops/panic\nsetting, if they manage to reset it. KFENCE is not a mitigation, but\nthis setting is meant to give a knob to reduce the risk that someone\ntakes advantage of KFENCE's heap layout - until now, KFENCE only\nreports and continues - the actual buggy access happily proceeds.\n\n",
          "reply_to": "Rik van Riel",
          "message_date": "2026-02-26",
          "message_id": ""
        }
      ],
      "analysis_source": "llm",
      "patch_summary": "The patch adds a new parameter kfence.fault to the kfence module, allowing users to toggle the behavior of KFENCE in case of a fault."
    }
  }
}