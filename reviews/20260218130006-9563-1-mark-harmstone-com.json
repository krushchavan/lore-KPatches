{
  "thread_id": "20260218130006.9563-1-mark@harmstone.com",
  "subject": "[PATCH] btrfs: fix unlikely in btrfs_insert_one_raid_extent()",
  "url": "https://lore.kernel.org/all/20260218130006.9563-1-mark@harmstone.com/",
  "dates": {
    "2026-02-18": {
      "report_file": "2026-02-18_ollama_llama3.1-8b.html",
      "developer": "Mark Harmstone",
      "reviews": [
        {
          "author": "Filipe Manana",
          "summary": "We use the Fixes tag for things that must be backported, which are aither bug fixes or rather severe performance regressions (i.e. things that affect users), and this doesn't fit into these categories. Otherwise:",
          "sentiment": "neutral",
          "sentiment_signals": [],
          "has_inline_review": true,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "heuristic",
          "raw_body": "On Wed, Feb 18, 2026 at 1:01â€¯PM Mark Harmstone <mark@harmstone.com> wrote:\n>\n> Fix the unlikely added to btrfs_insert_one_raid_extent() by commit\n> a929904c: the exclamation point is in the wrong place, so we are telling\n> the compiler that allocation failure is actually expected.\n>\n> Signed-off-by: Mark Harmstone <mark@harmstone.com>\n> Fixes: a929904cf73b (\"btrfs: add unlikely annotations to branches leading to transaction abort\")\n\nWe use the Fixes tag for things that must be backported, which are\naither bug fixes or rather severe performance regressions (i.e. things\nthat affect users), and this doesn't fit into these categories.\n\nOtherwise:\n\nReviewed-by: Filipe Manana <fdmanana@suse.com>\n\n\n> ---\n>  fs/btrfs/raid-stripe-tree.c | 2 +-\n>  1 file changed, 1 insertion(+), 1 deletion(-)\n>\n> diff --git a/fs/btrfs/raid-stripe-tree.c b/fs/btrfs/raid-stripe-tree.c\n> index 2987cb7c686e..638c4ad572c9 100644\n> --- a/fs/btrfs/raid-stripe-tree.c\n> +++ b/fs/btrfs/raid-stripe-tree.c\n> @@ -300,7 +300,7 @@ int btrfs_insert_one_raid_extent(struct btrfs_trans_handle *trans,\n>         int ret;\n>\n>         stripe_extent = kzalloc(item_size, GFP_NOFS);\n> -       if (!unlikely(stripe_extent)) {\n> +       if (unlikely(!stripe_extent)) {\n>                 btrfs_abort_transaction(trans, -ENOMEM);\n>                 btrfs_end_transaction(trans);\n>                 return -ENOMEM;\n> --\n> 2.52.0\n>\n>\n",
          "reply_to": "",
          "message_date": "2026-02-18",
          "message_id": ""
        }
      ],
      "analysis_source": "heuristic",
      "patch_summary": "Fix the unlikely added to btrfs_insert_one_raid_extent() by commit a929904c: the exclamation point is in the wrong place, so we are telling the compiler that allocation failure is actually expected."
    },
    "2026-02-20": {
      "report_file": "2026-02-20.html",
      "developer": "Mark Harmstone",
      "reviews": [
        {
          "author": "Mark Harmstone (author)",
          "summary": "Okay - thanks Filipe, I'll push it with the Fixes line taken out.",
          "sentiment": "neutral",
          "sentiment_signals": [],
          "has_inline_review": true,
          "tags_given": [],
          "analysis_source": "heuristic",
          "raw_body": "On 18/02/2026 2.08 pm, Filipe Manana wrote:\n> On Wed, Feb 18, 2026 at 1:01\\u202fPM Mark Harmstone <mark@harmstone.com> wrote:\n>>\n>> Fix the unlikely added to btrfs_insert_one_raid_extent() by commit\n>> a929904c: the exclamation point is in the wrong place, so we are telling\n>> the compiler that allocation failure is actually expected.\n>>\n>> Signed-off-by: Mark Harmstone <mark@harmstone.com>\n>> Fixes: a929904cf73b (\"btrfs: add unlikely annotations to branches leading to transaction abort\")\n> \n> We use the Fixes tag for things that must be backported, which are\n> aither bug fixes or rather severe performance regressions (i.e. things\n> that affect users), and this doesn't fit into these categories.\n\nOkay - thanks Filipe, I'll push it with the Fixes line taken out.\n\n> Otherwise:\n> \n> Reviewed-by: Filipe Manana <fdmanana@suse.com>\n> \n> \n>> ---\n>>   fs/btrfs/raid-stripe-tree.c | 2 +-\n>>   1 file changed, 1 insertion(+), 1 deletion(-)\n>>\n>> diff --git a/fs/btrfs/raid-stripe-tree.c b/fs/btrfs/raid-stripe-tree.c\n>> index 2987cb7c686e..638c4ad572c9 100644\n>> --- a/fs/btrfs/raid-stripe-tree.c\n>> +++ b/fs/btrfs/raid-stripe-tree.c\n>> @@ -300,7 +300,7 @@ int btrfs_insert_one_raid_extent(struct btrfs_trans_handle *trans,\n>>          int ret;\n>>\n>>          stripe_extent = kzalloc(item_size, GFP_NOFS);\n>> -       if (!unlikely(stripe_extent)) {\n>> +       if (unlikely(!stripe_extent)) {\n>>                  btrfs_abort_transaction(trans, -ENOMEM);\n>>                  btrfs_end_transaction(trans);\n>>                  return -ENOMEM;\n>> --\n>> 2.52.0\n>>\n>>\n\n\n",
          "reply_to": "",
          "message_date": "2026-02-20",
          "message_id": ""
        }
      ],
      "analysis_source": "heuristic",
      "patch_summary": "Fix the unlikely added to btrfs_insert_one_raid_extent() by commit a929904c: the exclamation point is in the wrong place, so we are telling the compiler that allocation failure is actually expected."
    }
  }
}