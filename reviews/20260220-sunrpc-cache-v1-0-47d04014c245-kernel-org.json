{
  "thread_id": "20260220-sunrpc-cache-v1-0-47d04014c245@kernel.org",
  "subject": "[PATCH 0/3] sunrpc: cache infrastructure scalability improvements",
  "url": "https://lore.kernel.org/all/20260220-sunrpc-cache-v1-0-47d04014c245@kernel.org/",
  "dates": {
    "2026-02-20": {
      "report_file": "2026-02-20.html",
      "developer": "Jeff Layton",
      "reviews": [
        {
          "author": "Chuck Lever",
          "summary": "From: Chuck Lever <chuck.lever@oracle.com> Applied to nfsd-testing, thanks! [1/3] sunrpc: convert queue_lock from global spinlock to per-cache_detail lock commit: 8da8f32e9a2702259cdf97e2f8f492ef9c79db65 [2/3] sunrpc: convert queue_wait from global to per-cache_detail waitqueue commit: 802261d8b58dd2f41a52a0c92776e0fb45619efe [3/3] sunrpc: split cache_detail...",
          "sentiment": "positive",
          "sentiment_signals": [
            "applied"
          ],
          "has_inline_review": true,
          "tags_given": [],
          "analysis_source": "heuristic",
          "raw_body": "From: Chuck Lever <chuck.lever@oracle.com>\n\nOn Fri, 20 Feb 2026 07:26:02 -0500, Jeff Layton wrote:\n> I've been working on trying to retrofit a netlink upcall into the sunrpc\n> cache infrastructure. While crawling over that code, I noticed that it\n> relies on both a global spinlock and waitqueue. The first two patches\n> convert those to be per-cache_detail instead.\n> \n> The last patch splits up the cache_detail->queue into two lists: one to\n> hold cache_readers and one for cache_requests. This simplifies the code,\n> and the new sequence number that helps the readers track position may\n> help with implementing netlink upcalls.\n> \n> [...]\n\nApplied to nfsd-testing, thanks!\n\n[1/3] sunrpc: convert queue_lock from global spinlock to per-cache_detail lock\n      commit: 8da8f32e9a2702259cdf97e2f8f492ef9c79db65\n[2/3] sunrpc: convert queue_wait from global to per-cache_detail waitqueue\n      commit: 802261d8b58dd2f41a52a0c92776e0fb45619efe\n[3/3] sunrpc: split cache_detail queue into request and reader lists\n      commit: 0eb3d9dc71ada02909e4dfe9cb54e703ec717ed4\n\n--\nChuck Lever\n\n",
          "reply_to": "",
          "message_date": "2026-02-20",
          "message_id": ""
        }
      ],
      "analysis_source": "heuristic",
      "patch_summary": "I've been working on trying to retrofit a netlink upcall into the sunrpc cache infrastructure. While crawling over that code, I noticed that it relies on both a global spinlock and waitqueue. The first two patches convert those to be per-cache_detail instead.\n\nThe last patch splits up the cache_detail->queue into two lists: one to hold cache_readers and one for cache_requests. This simplifies the code, and the new sequence number that helps the readers track position may help with implementing netlink upcalls.\n\nPlease consider these for v7.1."
    },
    "2026-02-22": {
      "report_file": "2026-02-22_ollama_llama3.1-8b.html",
      "developer": "Jeff Layton",
      "reviews": [
        {
          "author": "NeilBrown",
          "summary": "reviewer noted that the code should also decrement ->readers and check if it's zero, similar to another part of the codebase, potentially fixing a bug introduced by the patch",
          "sentiment": "needs_work",
          "sentiment_signals": [
            "potential bug fix",
            "code review"
          ],
          "has_inline_review": false,
          "tags_given": [
            "Reviewed-by"
          ],
          "analysis_source": "llm",
          "raw_body": "Hmm..  The other place where we decrement ->readers we then check if it\nis zero and if CACHE_PENDING is clear - and do something.\nI suspect we should do that here.\nThis bug (if I'm right and it is a bug) if there before you patch, but\nnow might be a good time to fix it?\n\nThanks.  Nice cleanups.\n\nNeilBrown",
          "reply_to": "Jeff Layton",
          "message_date": "2026-02-22"
        }
      ],
      "analysis_source": "llm-per-reviewer",
      "patch_summary": "This patch series improves the scalability of the sunrpc cache infrastructure by converting a global spinlock and waitqueue to per-cache-detail locks and waitqueues, and splitting the cache detail queue into two separate lists for requests and readers."
    },
    "2026-02-23": {
      "report_file": "2026-02-23_ollama_llama3.1-8b.html",
      "developer": "Jeff Layton",
      "reviews": [
        {
          "author": "Jeff Layton (author)",
          "summary": "Author acknowledged a missing patch to address NeilBrown's feedback and plans to add it before the existing patches\n\nAuthor acknowledged that there were issues with the spinlocks in the patch, agreed to fix them in version 2.",
          "sentiment": "needs_work",
          "sentiment_signals": [
            "acknowledged a fix is needed",
            "plans to add a new patch",
            "acknowledged issues",
            "agreed to fix"
          ],
          "has_inline_review": false,
          "tags_given": [],
          "analysis_source": "llm",
          "raw_body": "Good catch. I'll add a patch to fix that preceding these patches, so it\ncan go to stable (if we think that's worthwhile).\n\n---\n\nThanks for the review! I'll send a v2 with the spinlock fixes and the\nabove bugfix.",
          "reply_to": "NeilBrown",
          "message_date": "2026-02-23"
        }
      ],
      "analysis_source": "llm-per-reviewer",
      "patch_summary": "This patch series improves the scalability of the sunrpc cache infrastructure by converting a global spinlock and waitqueue to per-cache-detail locks and waitqueues, and splitting the cache detail queue into two separate lists for requests and readers."
    }
  }
}